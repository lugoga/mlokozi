---
title: "Research Results"
author: "Ian Nyeme"
date: "July 29, 2018"
output:
  word_document: default
  html_document: default
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## R version
The analysis was done in R environmet using version 3.4.4 released on 2018-03-15, which can be download [here](http://cran.us.r-project.org/). The scripts work with this version or later



setting working directory
```{r}
setwd("E:/Data Manipulation/Ian Nyeme/")
```


required packages

```{r, warning=FALSE, comment= FALSE, message=FALSE}
require(haven)
require(tidyverse)
require(lubridate)
require(ggsci)
require(RColorBrewer)
```

read the questionnaire file
```{r}
# read the file
db = readxl::read_excel("Questionnaire responses 12082018.xlsx", sheet = 1)

# remove unwanted columns
# db = db[,-c(8,59:61)]

# da = db%>%select(-c('X8', 'X59','X60', 'X61'))
# rm(list = setdiff(ls(), "db"))

code1 = c("Strongly Disagree", "Disagree", "Agree", "Strongly Agree")
code2 = c("Very low", "Low", "Moderate", "High", "Very High")
```

check the structure of the data frame and change the variable names into questions
```{r}
# glimpse(db)
variable.names = names(db)

names(db) = rep(paste("q",1:57, sep = ""))

index = data_frame(variable.names, names(db))%>%select(question = `names(db)`, long.question = variable.names)


```

## Objectives

### First objective: 
To determine if design and build contract can improve project performance on  roadworks in Tanzania

```{r}
db%>%group_by(q3)%>%summarise(count = n())%>%mutate(Percentage = count/sum(count)*100)%>%rename(Age.group = q3)%>%knitr::kable(digits = 2, caption = "Table 1: ")


ggplot(data = db, aes(x = q2, fill = q2), col = 1)+geom_bar(width = 0.75)+scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = "right",  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percentage of Respondents", 
       subtitle = "")
```


```{r}
db$q2 = as.factor(db$q2)

#plot for question 8
ggplot(data = db, aes(x = q8, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,40,5))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = " Does it provides single point of contact between the Client and Contractor hence ensure the efficient \nutilization of resources on projects?")
  
  
```

```{r}

#plot for question 8
ggplot(data = db, aes(x = q9, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,25,5))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = "It ensures certainty of final project cost to be high")
  
  
```


```{r}

#plot for question 8
ggplot(data = db, aes(x = q10, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,35,6))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = "It ensures project management efficiency is improved due to improved communication")
  
  
```

```{r}

#plot for question 8
ggplot(data = db, aes(x = q11, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,30,5))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = "It increases effectiveness and efficiency as the structure of the organization is simple")
  
  
```

```{r}

#plot for question 8
ggplot(data = db, aes(x = q12, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = "It ensures the designing and construction risks are transferred to the Contractor hence improve performance \nstandards")
  
  
```

### Second objective: 
2. To investigate the current challenges caused by *traditional procurement system* on roadwork projects in Tanzania
```{r}

#plot for question 8
ggplot(data = db%>%mutate(q13 = replace(q13,q13==5,4)), 
       aes(x = q13, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = "TPS does not ensure cost certainty to the owner?")
  
  
```

```{r}

#plot for question 8
ggplot(data = db%>%mutate(q14 = replace(q14,q14==5,4)), 
       aes(x = q14, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = "Completion date is not rigid")
  
  
```


```{r}

#plot for question 8
ggplot(data = db%>%mutate(q15 = replace(q15,q15==5,4)), 
       aes(x = q15, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = "Stipulated price is not rigid")
  
  
```


```{r}

#plot for question 8
ggplot(data = db%>%mutate(q16 = replace(q16,q16==5,4)), 
       aes(x = q16, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = "Design should be completed before tendering")
  
  
```



```{r}

#plot for question 17
ggplot(data = db%>%mutate(q17 = replace(q17,q17==5,4)), 
       aes(x = q17, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = "Cost overrun due to new design and specification")
  
  
```



```{r}

#plot for question 18
ggplot(data = db%>%mutate(q18 = replace(q18,q18==5,4)), 
       aes(x = q18, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = "Cost overrun due to quantities and variation of price factors")
  
  
```



```{r}

#plot for question 19
ggplot(data = db%>%mutate(q19 = replace(q19,q19==5,4)), 
       aes(x = q19, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[19,2])
  
  
```

```{r}

#plot for question 20
ggplot(data = db%>%mutate(q20 = replace(q20,q20==5,4)), 
       aes(x = q20, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[20,2])
  
  
```



```{r}

#plot for question 21
ggplot(data = db%>%mutate(q21 = replace(q21,q21==5,4)), 
       aes(x = q21, fill = q2))+
  geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[21,2])
  
  
```




### Third objective: 
3. To investigate the challanges that hinder the client to move from traditional procurement to designa build

```{r}

#plot for question 22
ggplot(data = db%>%mutate(q22 = replace(q22,q22==5,4)), 
       aes(x = q22, fill = q2))+
    geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[22,2])
  
  
```



```{r}

#plot for question 22
ggplot(data = db%>%mutate(q23 = replace(q23,q23==5,4)), 
       aes(x = q23, fill = q2))+
    geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[23,2])
  
  
```


```{r}

#plot for question 22
ggplot(data = db%>%mutate(q24 = replace(q24,q24==5,4)), 
       aes(x = q24, fill = q2))+
    geom_bar(col = 1)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[24,2])
  
  
```


```{r}

#plot for question 22
ggplot(data = db%>%mutate(q25 = replace(q25,q25==5,4)), 
       aes(x = q25, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[25,2])
  
  
```



```{r}

#plot for question 22
ggplot(data = db%>%mutate(q26 = replace(q26,q26==5,4)), 
       aes(x = q26, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[26,2])
  
  
```


```{r}

#plot for question 22
ggplot(data = db%>%mutate(q27 = replace(q27,q27==5,4)), 
       aes(x = q27, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[27,2])
  
  
```



```{r}

#plot for question 22
ggplot(data = db%>%mutate(q28 = replace(q28,q28==5,4)), 
       aes(x = q28, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[28,2])
  
  
```

```{r}

#plot for question 22
ggplot(data = db%>%mutate(q28 = replace(q28,q28==5,4)), 
       aes(x = q28, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[28,2])
  
  
```



```{r}

#plot for question 22
ggplot(data = db%>%mutate(q29 = replace(q29,q29==5,4)), 
       aes(x = q29, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[29,2])


```



```{r}

#plot for question 22
ggplot(data = db%>%mutate(q30 = replace(q30,q30==5,4)), 
       aes(x = q30, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code1)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[30,2])

## how to convert count to percentage
aa = db%>%mutate(q30 = replace(q30,q30==5,4))%>%group_by(q2,q30)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q30, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code1)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,44,8))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[30,2])
  
  
```


```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q31, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  # scale_y_continuous(breaks = seq(0,25,6))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[31,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q31)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q31, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,44,8))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[31,2])
  
  
```



```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q32, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,15,3))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[32,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q32)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q32, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,28,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[32,2])
  
  
```





```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q33, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,15,3))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[33,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q33)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q33, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,30,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[33,2])
  
  
```




```{r}


#plot for question 22
ggplot(data = db, 
       aes(x = q34, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,15,3))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[34,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q34)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q34, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,28,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[34,2])
  
  
```




```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q35, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,25,4))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[35,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q35)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q35, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,42,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[35,2])
  
  
```




```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q36, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,22,3))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[36,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q36)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q36, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,36,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[36,2])
  
  
```



```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q37, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,14,2))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[37,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q37)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q37, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,28,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[37,2])
  
  
```




```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q38, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,15,2))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[38,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q38)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q38, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,28,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[38,2])
  
  
```



```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q39, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,25,4))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[39,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q39)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q39, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,42,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[39,2])
  
  
```




```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q40, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,15,3))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[40,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q40)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q40, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,28,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[40,2])
  
  
```




```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q41, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,15,3))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[41,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q41)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q41, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,28,7))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[41,2])
  
  
```





```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q42, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,15,3))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[42,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q42)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q42, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,30,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[42,2])
  
  
```




```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q43, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,14,2))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[43,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q43)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q43, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,28,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[43,2])
  
  
```




```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q44, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,18,4))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[44,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q44)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q44, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,30,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[44,2])
  
  
```




```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q45, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,16,2))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[45,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q45)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q45, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,28,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[45,2])
  
  
```



```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q46, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,16,4))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[46,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q46)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q46, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,30,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[46,2])
  
  
```




```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q47, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,18,3))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[47,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q47)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q47, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,40,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[47,2])
  
  
```



```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q48, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,15,3))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[48,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q48)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q48, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,28,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[48,2])
  
  
```


### Fourth objective: 
4. To suggest ways of which design abuild can be used to reduce or eliminate current cost escalation on roadworks projects in tanzania


```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q49, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,30,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[49,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q49)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q49, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,48,7))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[49,2])
  
  
```




```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q50, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,30,3))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[50,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q50)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q50, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,50,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[50,2])
  
  
```



```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q51, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,30,3))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[51,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q51)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q51, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,40,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[51,2])
  
  
```



```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q52, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,30,3))+
  theme_bw()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[52,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q52)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q52, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,50,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.9,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[52,2])
  
  
```




```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q53, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,25,3))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[53,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q53)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q53, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,50,9))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[53,2])
  
  
```




```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q54, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,30,6))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[54,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q54)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q54, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,50,9))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[54,2])
  
  
```



```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q55, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,30,3))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[55,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q55)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q55, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,50,6))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[55,2])
  
  
```



### plot for question 56
```{r}

#plot for question 22
ggplot(data = db, 
       aes(x = q56, fill = q2))+
    geom_bar(col = 1, position = "stack", width = .9)+
  scale_x_discrete(limits = code2)+
  # scale_fill_discrete(name = "Respondents")+
  # scale_fill_brewer(name = "Respondents",palette = "Dark2")+
  # scale_fill_jco(name = "Respondents")+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,30,5))+
  theme_bw()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Number of Respondents", 
       subtitle = index[56,2])

## how to convert count to percentage
aa = db%>%group_by(q2,q56)%>%count()

data.frame(aa, perc= aa$n%>%
             prop.table()*100)%>%
  ggplot()+
  geom_col(aes(x = q56, y = perc, fill = q2), col = 1)+
  scale_x_discrete(limits = code2)+
  scale_fill_viridis_d(name = "Respondents")+
  scale_y_continuous(breaks = seq(0,45,8))+
  theme_bw()+
  # cowplot::theme_cowplot()+
  theme(legend.position = c(0.1,0.85),  
        legend.background = element_rect(colour = "black"),
        panel.grid.minor.y = element_blank())+
  labs(x = NULL, y = "Percent of Respondents", 
       subtitle = index[56,2])
  
  
```



## Hypotheses

1. Design and Build contract will not improve project performance on roadwork projects in Tanzania
2. Traditional procurement does not contribute to poor performance on roadwork projects in Tanzania
3. There no are challenges that hinder the client to move from traditional procurement system to desing and build contract



## index
age of respoondend and experience in the construction sector matches?
```{r}
db%>%group_by(q3,q7)%>%count()%>%arrange(desc(q7))
```

## ever used the DB
```{r}
db%>%group_by(q2,q4)%>%count()
```

